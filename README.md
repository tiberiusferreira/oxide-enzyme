# oxide-enzyme
Experimental usage of https://github.com/wsmoses/Enzyme with Rust

Only supported on MacOS for now. (but you can always compile LLVMEnzyme-11 to another target)

Run with `compile_release.sh` script, should result in:

```
    Finished release [optimized] target(s) in 0.04s
     Running `target/release/post`
warning: overriding the module target triple with x86_64-apple-macosx10.15.0 [-Woverride-module]
1 warning generated.
Loss: 0.30891240920562774
Net output: [0.00899310498104578, 0.00899310498104578, 0.4910068950189542, 0.4910068950189542]
Loss: 0.2859638700419143
Net output: [0.009194321529933875, 0.008765413341757925, 0.5176498946461312, 0.4643903704821769]
Loss: 0.2448887054140632
Net output: [0.009519707924755885, 0.008269719888589046, 0.5689987267653589, 0.41321184542129624]
Loss: 0.19408056715161556
Net output: [0.009821716690099794, 0.007467336060067859, 0.6396161675393177, 0.34309477971051466]
Loss: 0.14294731569096336
Net output: [0.009923646355073111, 0.006385392864904454, 0.7195362597284621, 0.26415470105156036]
Loss: 0.09882157561977108
Net output: [0.009701840338430004, 0.005148047306281721, 0.7964865095896545, 0.1886636027656337]
Loss: 0.0650887715321039
Net output: [0.009149132574834051, 0.0039295853245679855, 0.8608177795974422, 0.12610350250315566]
Loss: 0.041552196666130393
Net output: [0.008358682551526967, 0.0028696458012497706, 0.9087570714745615, 0.08001460017266167]
Loss: 0.02613782073895303
Net output: [0.0074551915913519265, 0.002029418286188141, 0.9415907409530004, 0.04892464916945957]
Loss: 0.016434444023579898
Net output: [0.006540498060874319, 0.0014046565845541989, 0.9628653448084341, 0.029189500546137486]
Loss: 0.01045360991798631
Net output: [0.005677194110963668, 0.0009589855144038459, 0.9762170535468129, 0.017146766827819536]
Loss: 0.006793566989541995
Net output: [0.004895218911976843, 0.000649179357849508, 0.984478946519917, 0.00997665521025671]
Loss: 0.004545639678803816
Net output: [0.004203818250028855, 0.000437181554507815, 0.9895878633640368, 0.005771136831426539]
Loss: 0.003147518080915586
Net output: [0.003601128121377798, 0.0002934820534421282, 0.9927787710641388, 0.003326618761041493]
Loss: 0.0022599390570452117
Net output: [0.003080156221895989, 0.00019663152669161232, 0.9948098138191079, 0.00191339843230459]
Loss: 0.001680802550873109
Net output: [0.0026320629954625467, 0.00013158122673500802, 0.996137288638697, 0.0010990671391052928]
Loss: 0.0012902758225073155
Net output: [0.002247806868884909, 0.00008798214129332087, 0.9970334390888622, 0.0006307719009595747]
Loss: 0.001017223447510724
Net output: [0.001918895560432558, 0.00005879907406059792, 0.9976604973655545, 0.0003618079999523728]
Loss: 0.000819162495395448
Net output: [0.0016376784348520134, 0.000039281936712500364, 0.9981155863903727, 0.00020745323806274751]
Loss: 0.0006704465867071621
Net output: [0.0013974148410427535, 0.000026236530175326005, 0.9984574306688123, 0.00011891795996963376]
Loss: 0.0005553458260874964
Net output: [0.0011922395893028462, 0.000017520231130510068, 0.9987220862075306, 0.00006815397203630252]
Loss: 0.00046400423908912335
Net output: [0.0010170860911577432, 0.00001169802119667452, 0.9989321613019334, 0.000039054585712082096]
Loss: 0.000390077492236668
Net output: [0.0008675964973291687, 0.000007809754668235856, 0.9991022166301244, 0.00002237711787813575]
Loss: 0.0003293488150323769
Net output: [0.000740032475090547, 0.000005213439162559363, 0.9992419338055826, 0.000012820280164302794]
Loss: 0.00027891396739654085
Net output: [0.0006311925010429217, 0.000003480007886924918, 0.9993579830375875, 0.0000073444534826875334]
Loss: 0.00023669756542267956
Net output: [0.0005383377739568012, 0.00000232279330377415, 0.9994551322087071, 0.00000420722403238846]
Loss: 0.0002011628615992685
Net output: [0.00045912707179524215, 0.0000015503137131616659, 0.9995369126516781, 0.0000024099628134910626]
Loss: 0.0001711349595119509
Net output: [0.0003915600801406659, 0.0000010346911395084518, 0.9996060248219479, 0.0000013804067719816725]
Loss: 0.00014569097192906698
Net output: [0.00033392840296790215, 0.0000006905367492317216, 0.9996645904022324, 0.0000007906580505100705]
Loss: 0.00012409004615935906
Net output: [0.00028477338091827294, 0.00000046083993687739317, 0.9997143129258507, 0.000000452853294218723]
Loss: 0.00010572742899206382
Net output: [0.00024284986305500586, 0.0000003075407054320575, 0.999756583228753, 0.00000025936748651726355]
Loss: 0.00009010326923578955
Net output: [0.00020709514451562532, 0.000000205232397180463, 0.999792551075932, 0.000000148547155178822]
Loss: 0.00007680065001593662
Net output: [0.00017660236481033031, 0.00000013695611179455818, 0.9998231756034178, 0.00000008507565996515136]
Loss: 0.00006546955603264012
Net output: [0.00015059774560007531, 0.00000009139243939382656, 0.9998492621383276, 0.00000004872363289129566]
Loss: 0.00005581477761910571
Net output: [0.00012842112620972695, 0.00000006098646483276653, 0.9998714899832052, 0.00000002790412020849693]
Loss: 0.000047586517867114854
Net output: [0.00010950932729876953, 0.000000040696009579835017, 0.9998904339961248, 0.000000015980566903188264]
Loss: 0.000040572923568855396
Net output: [0.00009338193730125905, 0.000000027156017783476598, 0.9999065817547672, 0.000000009151913749354754]
Loss: 0.000034594034002598786
Net output: [0.00007962917262265339, 0.000000018120777978413408, 0.9999203474654307, 0.000000005241168862068626]
Loss: 0.000029496808388284572
Net output: [0.00006790151170449281, 0.000000012091623290615177, 0.9999320833951513, 0.0000000030015210939680597]
Loss: 0.000025150996617560445
Net output: [0.000057900845649414905, 0.000000008068444803881124, 0.9999420893669999, 0.0000000017189058987008766]
Loss: 0.000021445684005247355
Net output: [0.000049372924877775895, 0.000000005383849191625311, 0.9999506207068979, 0.0000000009843751325257181]
Loss: 0.000018286384180348366
Net output: [0.00004210091297233872, 0.000000003592477775140768, 0.9999578949308249, 0.0000000005637250265627313]
Loss: 0.000015592583616658906
Net output: [0.00003589988611222688, 0.000000002397141752838712, 0.999964097393917, 0.0000000003228289102131649]
Loss: 0.000013295661906718974
Net output: [0.00003061213988946113, 0.0000000015995285557298672, 0.9999693860757078, 0.00000000018487414535332344]
Loss: 0.000011337126842499201
Net output: [0.000026103185362376812, 0.0000000010673064458852244, 0.9999738956414598, 0.00000000010587143308293176]
Loss: 0.000009667114581490831
Net output: [0.00002225833338838646, 0.0000000007121726463994197, 0.99997774089381, 0.00000000006062900295497734]
Loss: 0.000008243113839521994
Net output: [0.000018979780994086154, 0.0000000004752045736092502, 0.9999810197090813, 0.00000000003472012076242179]
Loss: 0.000007028879895906028
Net output: [0.000016184126131392273, 0.0000000003170846538962486, 0.9999838155369011, 0.00000000001988297272797933]
Loss: 0.000005993509715847257
Net output: [0.000013800247935411868, 0.00000000021157737734849224, 0.999986199529101, 0.000000000011386252235564285]
Loss: 0.000005110654010381816
Net output: [0.000011767498803210834, 0.00000000014117659991683368, 0.9999882323534995, 0.000000000006520482999655305]
Loss: 0.000004357845790787497
Net output: [0.000010034162476692659, 0.00000000009420105488214452, 0.9999899657395881, 0.0000000000037340342122239996]
Loss: 0.0000037159280912191132
Net output: [0.000008556139030285481, 0.00000000006285624576870578, 0.999991443795975, 0.000000000002138338437806615]
Loss: 0.0000031685661492427545
Net output: [0.0000072958234007027975, 0.00000000004194119398650198, 0.9999927041334336, 0.0000000000012245436545099049]
Loss: 0.0000027018315419049824
Net output: [0.000006221148993840303, 0.000000000027985486956893445, 0.9999937788223194, 0.0000000000007012483111743948]
Loss: 0.0000023038476390658216
Net output: [0.000005304772084748403, 0.000000000018673456464741934, 0.9999946952088402, 0.0000000000004015772963747143]
Loss: 0.0000019644873186357985
Net output: [0.0000045233762949374854, 0.000000000012459951736403015, 0.9999954766110153, 0.0000000000002299674004362826]
Loss: 0.0000016751152312994003
Net output: [0.000003857079476366802, 0.00000000000831395821114854, 0.999996142912078, 0.00000000000013169316370415253]
Loss: 0.000001428368042151918
Net output: [0.0000032889279297528073, 0.0000000000055475237468562725, 0.9999967110664474, 0.00000000000007541540046148544]
Loss: 0.000001217967052573945
Net output: [0.0000028044651016522475, 0.000000000003701607611037811, 0.9999971955311535, 0.0000000000000431873671606892]
Loss: 0.0000010385584260764096
Net output: [0.000002391363795971487, 0.0000000000024699120214980375, 0.9999976086337092, 0.00000000000002473166249493329]
Loss: 0.0000008855769527212137
Net output: [0.000002039112548842925, 0.0000000000016480580268786661, 0.999997960885789, 0.000000000000014162822228412718]
Loss: 0.0000007551298827908579
Net output: [0.0000017387481919437973, 0.0000000000010996726841457627, 0.9999982612507002, 0.000000000000008110473698972125]
Loss: 0.00000064389787161379
Net output: [0.000001482627803112978, 0.0000000000007337604691019536, 0.9999985173714585, 0.000000000000004644538545802968]
Loss: 0.0000005490505169847451
Net output: [0.0000012642342442597285, 0.000000000000489604193076511, 0.9999987357652634, 0.0000000000000026597380554659333]
Loss: 0.0000004681743371631607
Net output: [0.000001078010340412647, 0.00000000000032669004373322114, 0.9999989219893314, 0.0000000000000015231234884974481]
Loss: 0.00000039921135857786476
Net output: [0.0000009192174819735955, 0.00000000000021798500964796964, 0.9999990807822993, 0.0000000000000008722306096085661]
Loss: 0.00000034040674919996455
Net output: [0.0000007838150532887709, 0.00000000000014545120543324557, 0.9999992161848009, 0.0000000000000004994908041063956]
Loss: 0.0000002902641656976978
Net output: [0.0000006683576202866674, 0.0000000000000970527825099466, 0.9999993316422824, 0.00000000000000028603793970579234]
Loss: 0.0000002475076775982309
Net output: [0.0000005699072616058248, 0.00000000000006475877612635073, 0.9999994300926736, 0.00000000000000016380221129636645]
Loss: 0.00000021104930089284324
Net output: [0.0000004859588128141169, 0.000000000000043210496090826427, 0.999999514041144, 0.00000000000000009380281208270627]

```
